<!doctype html><html lang="en">
<head>
<meta charset="utf-8">
<title>AnyRtttl – A feature rich arduino library for playing RTTTL melodies - end2end zone</title>
<meta name="description" content="end2end zone">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="twitter:card" content="summary_large_image">
<meta property="og:site_name" content="end2end zone">
<meta property="og:title" content="AnyRtttl – A feature rich arduino library for playing RTTTL melodies">
<meta property="og:description" content="end2end zone">
<meta property="og:type" content="article">
<meta property="og:url" content="https://end2endzone.github.io/anyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies/">
<meta property="og:image" content="https://end2endzone.github.io/wp-content/uploads/2016/05/AnyRtttl-arduino-library.jpg">
<meta property="og:image:alt" content>
<link rel="manifest" href="/favicon/site.webmanifest?v=1">
<link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png?v=1">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png?v=1">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png?v=1">
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg?v=1" color="#ffffff">
<link rel="shortcut icon" href="/favicon/favicon.ico?v=1">
<meta name="msapplication-config" content="/favicon/browserconfig.xml?v=1">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="theme-color" content="#ffffff">
<meta name="generator" content="Hugo 0.147.9">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/a11y-dark.min.css">
<link rel="stylesheet" href="/css/bundle.min.150c477221f0a4cd774059ec37d705d2dfd096e42675af327b9fc2bbbbaebf45.css" integrity="sha256-FQxHciHwpM13QFnsN9cF0t/QluQmda8ye5/Cu7uuv0U="><link rel="stylesheet" href="/css/add-on.css">
<link rel="stylesheet" href="/css/end2endzone.css">
<link rel="stylesheet" href="/css/button.css">
</head>
<body>
<header id="site-header">
<nav id="site-nav">
<h1 class="nav-title">
<a href="/" class="nav">
Blog
</a>
</h1>
<menu id="site-nav-menu" class="flyout-menu menu">
<a href="/" class="nav link"><i class='fa fa-home'></i> Home</a>
<a href="/about" class="nav link"><i class='far fa-id-card'></i> About</a>
<a href="/blog" class="nav link"><i class='far fa-newspaper'></i> Blog</a>
<a href="/categories" class="nav link"><i class='fas fa-sitemap'></i> Categories</a>
<a href="/tags" class="nav link"><i class='fas fa-sitemap'></i> Tags</a>
<a href="/contact" class="nav link"><i class='far fa-envelope'></i> Contact</a>
<a href="#share-menu" class="nav link share-toggle"><i class="fas fa-share-alt">&nbsp;</i>Share</a>
<a href="#search-input" class="nav link search-toggle"><i class="fas fa-search">&nbsp;</i>Search</a>
</menu>
<a href="#search-input" class="nav search-toggle"><i class="fas fa-search fa-2x">&nbsp;</i></a>
<a href="#share-menu" class="nav share-toggle"><i class="fas fa-share-alt fa-2x">&nbsp;</i></a>
<a href="#lang-menu" class="nav lang-toggle" lang="en">en</a>
<a href="#site-nav" class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a>
</nav>
<menu id="search" class="menu"><input id="search-input" class="search-input menu"></input><div id="search-results" class="search-results menu"></div></menu>
<menu id="lang-menu" class="flyout-menu menu">
<a href="#" lang="en" class="nav link active">English (en)</a>
<a href="/fr" lang="fr" class="nav no-lang link">Français (fr)</a>
</menu>
<menu id="share-menu" class="flyout-menu menu">
<h1>Share Post</h1>
<a href="//twitter.com/share?text=AnyRtttl%20%e2%80%93%20A%20feature%20rich%20arduino%20library%20for%20playing%20RTTTL%20melodies&amp;url=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f" target="_blank" rel="noopener" class="nav share-btn twitter">
<p>Twitter</p>
</a>
<a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f" target="_blank" rel="noopener" class="nav share-btn facebook">
<p>Facebook</p>
</a>
<a href="//www.reddit.com/submit?url=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f&amp;title=AnyRtttl%20%e2%80%93%20A%20feature%20rich%20arduino%20library%20for%20playing%20RTTTL%20melodies" target="_blank" rel="noopener" class="nav share-btn reddit">
<p>Reddit</p>
</a>
<a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f&amp;title=AnyRtttl%20%e2%80%93%20A%20feature%20rich%20arduino%20library%20for%20playing%20RTTTL%20melodies" target="_blank" rel="noopener" class="nav share-btn linkedin">
<p>LinkedIn</p>
</a>
<a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f&amp;description=AnyRtttl%20%e2%80%93%20A%20feature%20rich%20arduino%20library%20for%20playing%20RTTTL%20melodies" target="_blank" rel="noopener" class="nav share-btn pinterest">
<p>Pinterest</p>
</a>
<a href="mailto:?subject=Check%20out%20this%20post%20by &amp;body=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f" target="_blank" class="nav share-btn email" data-proofer-ignore>
<p>Email</p>
</a>
</menu>
</header>
<div id="wrapper">
<section id="site-intro">
<a href="/"><img src="/img/main/logo.jpg" class="circle" width="100" alt="Hey that's me"></a>
<header>
<h1>end2end zone</h1>
</header>
<main>
<p>My life dumped to a web site</p>
</main>
<footer>
<ul class="socnet-icons">
</ul>
</footer>
</section>
<main id="site-main">
<article>
<div class="post">
<header>
<div class="title">
<h2><a href="/anyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies/">AnyRtttl – A feature rich arduino library for playing RTTTL melodies</a></h2>
</div>
<div class="meta">
<time datetime="2016-05-21 23:20:34 +0000 UTC">May 21, 2016</time>
<p>end2end</p>
<p>10-Minute Read</p>
</div>
</header>
<div id="socnet-share">
<a href="//twitter.com/share?text=AnyRtttl%20%e2%80%93%20A%20feature%20rich%20arduino%20library%20for%20playing%20RTTTL%20melodies&amp;url=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f" target="_blank" rel="noopener" class="nav share-btn twitter">
<p>Twitter</p>
</a>
<a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f" target="_blank" rel="noopener" class="nav share-btn facebook">
<p>Facebook</p>
</a>
<a href="//www.reddit.com/submit?url=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f&amp;title=AnyRtttl%20%e2%80%93%20A%20feature%20rich%20arduino%20library%20for%20playing%20RTTTL%20melodies" target="_blank" rel="noopener" class="nav share-btn reddit">
<p>Reddit</p>
</a>
<a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f&amp;title=AnyRtttl%20%e2%80%93%20A%20feature%20rich%20arduino%20library%20for%20playing%20RTTTL%20melodies" target="_blank" rel="noopener" class="nav share-btn linkedin">
<p>LinkedIn</p>
</a>
<a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f&amp;description=AnyRtttl%20%e2%80%93%20A%20feature%20rich%20arduino%20library%20for%20playing%20RTTTL%20melodies" target="_blank" rel="noopener" class="nav share-btn pinterest">
<p>Pinterest</p>
</a>
<a href="mailto:?subject=Check%20out%20this%20post%20by &amp;body=https%3a%2f%2fend2endzone.github.io%2fanyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies%2f" target="_blank" class="nav share-btn email" data-proofer-ignore>
<p>Email</p>
</a>
</div>
<div class="content">
<a href="/anyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies/" class="image" style="--bg-image:url('/wp-content/uploads/2016/05/AnyRtttl-arduino-library.jpg')">
<img class="stretchV" src="/wp-content/uploads/2016/05/AnyRtttl-arduino-library.jpg" alt>
</a>
<div class="expand">
<div class="expand-label" style="cursor:pointer" onclick='$h=$(this),$h.next("div").slideToggle(100,function(){$h.children("i").attr("class",function(){return $h.next("div").is(":visible")?"fas fa-chevron-down":"fas fa-chevron-right"})})'>
<i style="font-size:x-small" class="fas fa-chevron-right"></i>
<span>
Table of contents
</span>
</div><div class="expand-content" style="display:block">
<aside>
<nav id="TableOfContents">
<ol>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#purpose">Purpose</a></li>
<li><a href="#library-features">Library features</a>
<ol>
<li><a href="#non-blocking">Non-Blocking</a></li>
<li><a href="#external-tone-or-timer-0-libraries">External Tone or Timer #0 libraries</a></li>
<li><a href="#binary-rtttl">Binary RTTTL</a></li>
</ol>
</li>
<li><a href="#usage">Usage</a>
<ol>
<li><a href="#non-blocking-mode">Non-blocking mode</a></li>
<li><a href="#play-16-bits-per-note-rtttl">Play 16 bits per note RTTTL</a></li>
<li><a href="#play-10-bits-per-note-rtttl">Play 10 bits per note RTTTL</a></li>
<li><a href="#custom-tone-function-aka-rtttl-2-code">Custom Tone function (a.k.a. RTTTL 2 code)</a></li>
</ol>
</li>
<li><a href="#binary-rtttl-format-definition">Binary RTTTL format definition</a>
<ol>
<li><a href="#10-bits-per-note-no-padding">10 bits per note (no padding)</a></li>
<li><a href="#16-bits-per-note-with-padding">16 bits per note (with padding)</a></li>
<li><a href="#playback">Playback</a></li>
</ol>
</li>
<li><a href="#license">License</a></li>
<li><a href="#download">Download</a></li>
</ol>
</nav>
</aside>
</div>
</div>
<h1 id="introduction">Introduction</h1>
<p>The following article is about yet another Arduino library that I have written. AnyRtttl is a feature rich arduino library for playing RTTTL melodies. The library offers much more interesting features than relying on the widely available <code>void play_rtttl(char *p)</code> function. The AnyRtttl is a feature rich library which supports all best RTTTL features.</p>
<p>Skip to the <a href="/anyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies/#Download">download section</a> for quick download.</p>
<h1 id="purpose">Purpose</h1>
<p>See this post for a <a href="/nonblockingrtttl-a-non-blocking-arduino-library-for-playing-rtttl-melodies/#Quick_recall_of_the_RTTTL_format">quick recall of the RTTTL format</a>.</p>
<p class="pleasenote">
Note that AnyRtttl library is a port from my <a href="/nonblockingrtttl-a-non-blocking-arduino-library-for-playing-rtttl-melodies/">NonBlockingRtttl arduino library</a> which is now deprecated since development has stopped.
</p>
<p>After publishing my NonBlockingRtttl arduino library, I started using the library in more complex projects which was requiring other libraries. I quickly ran into the hell of library dependencies and library conflicts. I realized that I needed more features that could help me prototype faster.</p>
<p>Other libraries available which allows you to &ldquo;play&rdquo; a melody in <a href="/anyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies/#Quick_recall_of_the_RTTTL_format">RTTTL f</a>ormat suffer the same issue: they are based on blocking APIs or the RTTTL data is not optimized for space.</p>
<p>AnyRtttl is different since it packs multiple RTTTL related features in a single library. It supports <a href="https://en.wikipedia.org/wiki/Blocking_%28computing%29">blocking</a> & <a href="http://en.wikipedia.org/wiki/Non-blocking_algorithm">non-blocking</a> API which makes it suitable to be used by more advanced algorithm. For instance, when using the non-blocking API, the melody can be stopped when a button is pressed. The library is also compatible with <em>external Tone libraries</em> and it supports highly compressed RTTTL binary formats.</p>
<h1 id="library-features">Library features</h1>
<p>Here is a list of all library features:</p>
<ul>
<li>Really small increase in memory & code footprint compared to the usual blocking algorithm.</li>
<li>Blocking & Non-Blocking modes available.</li>
<li>Support custom <code>tone()</code>, <code>noTone()</code>, <code>delay()</code> and <code>millis()</code> functions.</li>
<li>Compatible with external Tone libraries.</li>
<li>Supports highly compressed RTTTL binary format.</li>
<li>Supports RTTTL melodies stored in <em>Program Memory</em> (<code>PROGMEM</code>).</li>
<li>Play two monolithic melodies on two different pins using 2 <a href="https://www.google.com/?q=piezo+buzzer">piezo buzzer</a> with the help of an external Tone library.</li>
</ul>
<h2 id="non-blocking">Non-Blocking</h2>
<p>Most of the code that can &ldquo;play&rdquo; a melody on internet are all build the same way: sequential calls to <code>tone()</code> and <code>delay()</code> functions using hardcoded values. This type of implementation might be good for robots but not for realtime application or projects that needs to monitor pins while the song is playing.</p>
<p>With AnyRtttl non-blocking mode, your program can read/write IOs pins while playing and react on changes. Implementing a &ldquo;stop&rdquo; or &ldquo;next song&rdquo; push button is a breeze!</p>
<h2 id="external-tone-or-timer-0-libraries">External Tone or Timer #0 libraries</h2>
<p>The AnyRtttl library is also flexible by allowing you to use the build-in arduino <code>tone()</code> and <code>noTone()</code> functions or an implementation from any external library which makes it compatible with any <em>Tone library</em> in the market.</p>
<p>The library also supports custom <code>delay()</code> and <code>millis()</code> functions. If a projects requires modification to the microcontroller&rsquo;s build-in Timer #0, the <code>millis()</code> function may be impacted and behave incorrectly. To maximize compatibility, one can supply a custom function which behaves like the original to prevent altering playback.</p>
<h2 id="binary-rtttl">Binary RTTTL</h2>
<p>The AnyRtttl library also supports playing RTTTL data which is stored as binary data instead of text. This is actually a custom implementation of the RTTTL format. Using these format, one can achieve storing an highly compressed RTTTL melody which saves memory.</p>
<p>See the <a href="/anyrtttl-a-feature-rich-arduino-library-for-playing-rtttl-melodies/#Binary_RTTTL_format_definition">Binary RTTTL format definition</a> section for details.</p>
<h1 id="usage">Usage</h1>
<p>Define ANY_RTTTL_INFO to enable the debugging of the library state on the serial port.</p>
<p>Use ANY_RTTTL_VERSION to get the current version of the library.</p>
<h2 id="non-blocking-mode">Non-blocking mode</h2>
<p>Call <code>anyrtttl::begin()</code> to setup the AnyRtttl library in non-blocking mode. Then call <code>anyrtttl::play()</code> to update the library&rsquo;s state and play notes as required.</p>
<p>Use <code>anyrtttl::done()</code> or <code>anyrtttl::isPlaying()</code> to know if the library is done playing the given song.</p>
<p>Anytime one can call <code>anyrtttl::stop()</code> to stop playing the current song.</p>
<p>Demo:</p>
<p>The following demo show how to use the library in non-blocking mode:</p>
<a href="/wp-content/uploads/2016/05/AnyRtttl-v2.0-NonBlocking-example.ino" target="_blank" class="btn btn-default">
<i class="fas fa-download"></i>
AnyRtttl-v2.0-NonBlocking-example.ino
</a>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;anyrtttl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;binrtttl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;pitches.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//project&#39;s contants
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define BUZZER_PIN 8
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">tetris</span> <span class="o">=</span> <span class="s">&#34;tetris:d=4,o=5,b=160:e6,8b,8c6,8d6,16e6,16d6,8c6,8b,a,8a,8c6,e6,8d6,8c6,b,8b,8c6,d6,e6,c6,a,2a,8p,d6,8f6,a6,8g6,8f6,e6,8e6,8c6,e6,8d6,8c6,b,8b,8c6,d6,e6,c6,a,a&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">arkanoid</span> <span class="o">=</span> <span class="s">&#34;Arkanoid:d=4,o=5,b=140:8g6,16p,16g.6,2a#6,32p,8a6,8g6,8f6,8a6,2g6&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">mario</span> <span class="o">=</span> <span class="s">&#34;mario:d=4,o=5,b=100:16e6,16e6,32p,8e6,16c6,8e6,8g6,8p,8g,8p,8c6,16p,8g,16p,8e,16p,8a,8b,16a#,8a,16g.,16e6,16g6,8a6,16f6,8g6,8e6,16c6,16d6,8b,16p,8c6,16p,8g,16p,8e,16p,8a,8b,16a#,8a,16g.,16e6,16g6,8a6,16f6,8g6,8e6,16c6,16d6,8b,8p,16g6,16f#6,16f6,16d#6,16p,16e6,16p,16g#,16a,16c6,16p,16a,16c6,16d6,8p,16g6,16f#6,16f6,16d#6,16p,16e6,16p,16c7,16p,16c7,16c7,p,16g6,16f#6,16f6,16d#6,16p,16e6,16p,16g#,16a,16c6,16p,16a,16c6,16d6,8p,16d#6,8p,16d6,8p,16c6&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">byte</span> <span class="n">songIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">//which song to play when the previous one finishes
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">pinMode</span><span class="p">(</span><span class="n">BUZZER_PIN</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">anyrtttl</span><span class="o">::</span><span class="n">nonblocking</span><span class="o">::</span><span class="n">isPlaying</span><span class="p">()</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">songIndex</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">anyrtttl</span><span class="o">::</span><span class="n">nonblocking</span><span class="o">::</span><span class="n">begin</span><span class="p">(</span><span class="n">BUZZER_PIN</span><span class="p">,</span> <span class="n">mario</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">songIndex</span><span class="o">++</span><span class="p">;</span> <span class="c1">//ready for next song
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">      <span class="c1">//play for 5 sec then stop.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">//note: this is a blocking code section
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="c1">//use to demonstrate the use of stop()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">start</span> <span class="o">=</span> <span class="n">millis</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">while</span><span class="p">(</span> <span class="n">millis</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="mi">5000</span> <span class="p">)</span> 
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">anyrtttl</span><span class="o">::</span><span class="n">nonblocking</span><span class="o">::</span><span class="n">play</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">anyrtttl</span><span class="o">::</span><span class="n">nonblocking</span><span class="o">::</span><span class="n">stop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">songIndex</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">anyrtttl</span><span class="o">::</span><span class="n">nonblocking</span><span class="o">::</span><span class="n">begin</span><span class="p">(</span><span class="n">BUZZER_PIN</span><span class="p">,</span> <span class="n">arkanoid</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">songIndex</span><span class="o">++</span><span class="p">;</span> <span class="c1">//ready for next song
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">songIndex</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">anyrtttl</span><span class="o">::</span><span class="n">nonblocking</span><span class="o">::</span><span class="n">begin</span><span class="p">(</span><span class="n">BUZZER_PIN</span><span class="p">,</span> <span class="n">tetris</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">songIndex</span><span class="o">++</span><span class="p">;</span> <span class="c1">//ready for next song
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">anyrtttl</span><span class="o">::</span><span class="n">nonblocking</span><span class="o">::</span><span class="n">play</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
<h2 id="play-16-bits-per-note-rtttl">Play 16 bits per note RTTTL</h2>
<p>Note that this mode requires that an RTTTL melody be already converted to 16-bits per note binary format. Use the <code>anyrtttl::blocking::play16Bits()</code> API for playing an RTTTL melody encoded as 16 bits per note.</p>
<p>Use the <code>anyrtttl::blocking::play16Bits()</code> API for playing an RTTTL melody encoded as 16 bits per note.</p>
<p>Demo:</p>
<p>The following demo show how to use the library with 16-bits per note binary RTTTL:</p>
<a href="/wp-content/uploads/2016/05/AnyRtttl-v2.0-Play-16-bits-example.ino" target="_blank" class="btn btn-default">
<i class="fas fa-download"></i>
AnyRtttl-v2.0-Play-16-bits-example.ino
</a>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;anyrtttl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;binrtttl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;pitches.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//project&#39;s contants
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define BUZZER_PIN 8
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//RTTTL 16 bits binary format for the following: tetris:d=4,o=5,b=160:e6,8b,8c6,8d6,16e6,16d6,8c6,8b,a,8a,8c6,e6,8d6,8c6,b,8b,8c6,d6,e6,c6,a,2a,8p,d6,8f6,a6,8g6,8f6,e6,8e6,8c6,e6,8d6,8c6,b,8b,8c6,d6,e6,c6,a,a
</span></span></span><span class="line"><span class="cl"><span class="c1">//Compatible with AnyRtttl library v2.0
</span></span></span><span class="line"><span class="cl"><span class="c1">//The code &amp; updates for the AnyRtttl library can be found on http://end2endzone.com
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">tetris16</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">tetris16_length</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">pinMode</span><span class="p">(</span><span class="n">BUZZER_PIN</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">anyrtttl</span><span class="o">::</span><span class="n">blocking</span><span class="o">::</span><span class="n">play16Bits</span><span class="p">(</span><span class="n">BUZZER_PIN</span><span class="p">,</span> <span class="n">tetris16</span><span class="p">,</span> <span class="n">tetris16_length</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">while</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
<h2 id="play-10-bits-per-note-rtttl">Play 10 bits per note RTTTL</h2>
<p>Note that this mode requires that an RTTTL melody be already converted to 10-bits per note binary format.</p>
<p>Create a function that will be used by AnyRtttl library to read bits as required. The signature of the library must look like this:
<code>uint16_t function_name(uint8_t numBits)</code>.</p>
<p>Note that this demo uses the <a href="/bitreader-an-arduino-library-for-reading-writing-data-as-chunks-of-bits/">arduino BitReader library</a> to extract bits from the RTTTL binary buffer. The implementation of <code>readNextBits()</code> function delegates the job to the BitReader&rsquo;s <code>read()</code> method.</p>
<p>In the <code>setup()</code> function, setup the external library that is used for reading bits: <code>bitreader.setBuffer(tetris10);</code></p>
<p>Use the <code>anyrtttl::blocking::play10Bits()</code> API for playing an RTTTL melody encoded as 10 bits per note. The 3rd argument of the function requires a pointer to the function extracting bits: <code>&amp;function_name</code>.</p>
<p>Demo:</p>
<p>The following demo show how to use the library with 10-bits per note binary RTTTL:</p>
<a href="/wp-content/uploads/2016/05/AnyRtttl-v2.0-Play-10-bits-example.ino" target="_blank" class="btn btn-default">
<i class="fas fa-download"></i>
AnyRtttl-v2.0-Play-10-bits-example.ino
</a>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;anyrtttl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;binrtttl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;pitches.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;bitreader.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//project&#39;s contants
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define BUZZER_PIN 8
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//RTTTL 10 bits binary format for the following: tetris:d=4,o=5,b=160:e6,8b,8c6,8d6,16e6,16d6,8c6,8b,a,8a,8c6,e6,8d6,8c6,b,8b,8c6,d6,e6,c6,a,2a,8p,d6,8f6,a6,8g6,8f6,e6,8e6,8c6,e6,8d6,8c6,b,8b,8c6,d6,e6,c6,a,a
</span></span></span><span class="line"><span class="cl"><span class="c1">//Compatible with AnyRtttl library v2.0
</span></span></span><span class="line"><span class="cl"><span class="c1">//The code &amp; updates for the AnyRtttl library can be found on http://end2endzone.com
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">tetris10</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">int</span> <span class="n">tetris10_length</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//bit reader support
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#ifndef USE_BITADDRESS_READ_WRITE
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">BitReader</span> <span class="n">bitreader</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">#else
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="n">BitAddress</span> <span class="n">bitreader</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cp">#endif
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="kt">uint16_t</span> <span class="nf">readNextBits</span><span class="p">(</span><span class="kt">uint8_t</span> <span class="n">numBits</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">uint16_t</span> <span class="n">bits</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">bitreader</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">numBits</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">bits</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">bits</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">pinMode</span><span class="p">(</span><span class="n">BUZZER_PIN</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">bitreader</span><span class="p">.</span><span class="n">setBuffer</span><span class="p">(</span><span class="n">tetris10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">anyrtttl</span><span class="o">::</span><span class="n">blocking</span><span class="o">::</span><span class="n">play10Bits</span><span class="p">(</span><span class="n">BUZZER_PIN</span><span class="p">,</span> <span class="n">tetris10_length</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">readNextBits</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">while</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
<h2 id="custom-tone-function-aka-rtttl-2-code">Custom Tone function (a.k.a. RTTTL 2 code)</h2>
<p>This demo shows how custom functions can be used by the AnyRtttl library. This example shows how to convert an RTTTL melody to arduino code.</p>
<p>First define replacement functions like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">serialTone</span><span class="p">(</span><span class="n">byte</span> <span class="n">pin</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">frequency</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">duration</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&#34;tone(&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">pin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&#34;,&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">frequency</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&#34;,&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">duration</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&#34;);&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">serialNoTone</span><span class="p">(</span><span class="n">byte</span> <span class="n">pin</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&#34;noTone(&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">pin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&#34;);&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">serialDelay</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">duration</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&#34;delay(&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">duration</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&#34;);&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Each new functions prints the function call & arguments to the serial port.</p>
<p>In the <code>setup()</code> function, setup the AnyRtttl library to use the new functions:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">//Use custom functions
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">anyrtttl</span><span class="o">::</span><span class="n">setToneFunction</span><span class="p">(</span><span class="o">&amp;</span><span class="n">serialTone</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">anyrtttl</span><span class="o">::</span><span class="n">setNoToneFunction</span><span class="p">(</span><span class="o">&amp;</span><span class="n">serialNoTone</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">anyrtttl</span><span class="o">::</span><span class="n">setDelayFunction</span><span class="p">(</span><span class="o">&amp;</span><span class="n">serialDelay</span><span class="p">);</span>
</span></span></code></pre></div><p>Use the <code>anyrtttl::blocking::play()</code> API for &ldquo;playing&rdquo; an RTTTL melody and monitor the output of the serial port to see the actual arduino code generated by the library.</p>
<p>Demo:</p>
<p>The following demo show how to use the library with custom functions:</p>
<a href="/wp-content/uploads/2016/05/AnyRtttl-v2.0-Rtttl-2-Code-example.ino" target="_blank" class="btn btn-default">
<i class="fas fa-download"></i>
AnyRtttl-v2.0-Rtttl-2-Code-example.ino
</a>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;anyrtttl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;binrtttl.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;pitches.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//project&#39;s contants
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="cp">#define BUZZER_PIN 8
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span> <span class="n">tetris</span> <span class="o">=</span> <span class="s">&#34;tetris:d=4,o=5,b=160:e6,8b,8c6,8d6,16e6,16d6,8c6,8b,a,8a,8c6,e6,8d6,8c6,b,8b,8c6,d6,e6,c6,a,2a,8p,d6,8f6,a6,8g6,8f6,e6,8e6,8c6,e6,8d6,8c6,b,8b,8c6,d6,e6,c6,a,a&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//*******************************************************************************************************************
</span></span></span><span class="line"><span class="cl"><span class="c1">//  The following replacement functions prints the function call &amp; parameters to the serial port.
</span></span></span><span class="line"><span class="cl"><span class="c1">//*******************************************************************************************************************
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">serialTone</span><span class="p">(</span><span class="n">byte</span> <span class="n">pin</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">frequency</span><span class="p">,</span> <span class="kt">uint32_t</span> <span class="n">duration</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&#34;tone(&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">pin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&#34;,&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">frequency</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&#34;,&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">duration</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&#34;);&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">serialNoTone</span><span class="p">(</span><span class="n">byte</span> <span class="n">pin</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&#34;noTone(&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">pin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&#34;);&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">serialDelay</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">duration</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">&#34;delay(&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">duration</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&#34;);&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">pinMode</span><span class="p">(</span><span class="n">BUZZER_PIN</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">//Use custom functions
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">anyrtttl</span><span class="o">::</span><span class="n">setToneFunction</span><span class="p">(</span><span class="o">&amp;</span><span class="n">serialTone</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">anyrtttl</span><span class="o">::</span><span class="n">setNoToneFunction</span><span class="p">(</span><span class="o">&amp;</span><span class="n">serialNoTone</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">anyrtttl</span><span class="o">::</span><span class="n">setDelayFunction</span><span class="p">(</span><span class="o">&amp;</span><span class="n">serialDelay</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">anyrtttl</span><span class="o">::</span><span class="n">blocking</span><span class="o">::</span><span class="n">play</span><span class="p">(</span><span class="n">BUZZER_PIN</span><span class="p">,</span> <span class="n">tetris</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">while</span><span class="p">(</span><span class="nb">true</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
<h1 id="binary-rtttl-format-definition">Binary RTTTL format definition</h1>
<p>The following section defines the field order and size (in bits) required for encoding / decoding of each melody as binary RTTTL.</p>
<p class="pleasenote">
Note that all fields definition are defined in LSB to MSB order.
</p>
<p>The first 16 bits stores the RTTTL default section which is defined as the following:</p>
<ol>
<li><strong>Default duration index</strong>, 3 bits, with values within [0, 7] range, matches the index used for <code>getNoteDurationFromIndex()</code> API.</li>
<li><strong>Default octave index</strong>, 2 bits, with values within [0, 3] range, matches the index used for <code>getNoteOctaveFromIndex()</code> API.</li>
<li><strong>Beats per minutes (BPM)</strong>, 10 bits, with values within [1, 900].</li>
<li><strong>Padding</strong>, 1 bit</li>
</ol>
<p>Next is each note&rsquo;s of the melody. Each note is encoded as 10 bits (or 16 bits) per note and is defined as the following:</p>
<ol>
<li><strong>Duration index</strong>, 3 bits, with values within [0, 7] range, matches the index used for <code>getNoteDurationFromIndex()</code> API.</li>
<li><strong>Note letter index</strong>, 3 bits, with values within [0, 7] range, matches the index used for <code>getNoteLetterFromIndex()</code> API.</li>
<li><strong>Pound</strong>, 1 bit, defines if the note is pounded or not.</li>
<li><strong>Dotted</strong>, 1 bit, defines if the note is dotted or not.</li>
<li><strong>Octave index</strong>, 2 bits, with values within [0, 3] range, matches the index used for <code>getNoteOctaveFromIndex()</code> API.</li>
<li><strong>Padding</strong>, 6 bits, <strong>optional</strong>. See sections below.</li>
</ol>
<p class="pleasenote">
The last field of a note (defined as <em>Padding</em>) is an <strong>optional 6 bits</strong> field. The AnyRtttl library supports both 10 bits per note and 16 bits per note definitions. Use the appropriate API for playing both format.
</p>
<h2 id="10-bits-per-note-no-padding">10 bits per note (no padding)</h2>
<p>Each RTTTL note is encoded into 10 bits which is the minimum size of a note. This storage method is the best compression method for storing RTTTL melodies and reduces the usage of the dynamic memory to the minimum.</p>
<p>However, since all notes are not aligned on multiple of 8 bits, addressing each note by an offset is impossible which makes the playback harder. Each notes must be <a href="http://en.wikipedia.org/wiki/Serialization">deserialized</a> one after the other. An additional library is required for deserializing a note from a buffer using blocks of 10 bits which may increase the program storage space footprint.</p>
<p>An external arduino library must also be used to allow the AnyRtttl library to consume bits as needed. The <a href="/bitreader-an-arduino-library-for-reading-writing-data-as-chunks-of-bits/">arduino BitReader library</a> may be used for handling bit deserialization but any library that can extract a given number of bits from a buffer would work.</p>
<h2 id="16-bits-per-note-with-padding">16 bits per note (with padding)</h2>
<p>Each RTTTL note is encoded into 16 bits which is much better than the average 3.28 bytes per note text format. This storage method is optimum for storing RTTTL melodies and reduces the usage of the dynamic memory without increasing to much program storage space.</p>
<p>All notes are aligned on 16 bits. Addressing each note by an offset allows an easy playback. Only the first 10 bits of each 16 bits block is used. The value of the padding field is undefined.</p>
<h2 id="playback">Playback</h2>
<p>The following AnyRtttl blocking APIs are available for playing both format:</p>
<ul>
<li>10 bits per note: <code>play10Bits()</code>.</li>
<li>16 bits per note: <code>play16Bits()</code>.</li>
</ul>
<h1 id="license">License</h1>
<p>Copyright (C) 2016 Antoine Beauchamp</p>
<p>AnyRtttl is licensed under the MIT License:</p>
<p>A short and simple permissive license with conditions only requiring preservation of copyright and license notices. Licensed works, modifications, and larger works may be distributed under different terms and without source code.</p>
<p>The full license is available <a href="https://github.com/end2endzone/bin2cpp/blob/master/LICENSE">here</a>.</p>
<h1 id="download">Download</h1>
<p>You can download the AnyRtttl library by clicking on the following link:
<a href="https://github.com/end2endzone/AnyRtttl/archive/refs/tags/2.3.1.zip" target="_blank" class="btn btn-default">
<i class="fas fa-download"></i>
AnyRtttl v2.3.1.zip
</a></p>
</div>
<footer>
<div class="stats">
<ul class="categories">
<li><a class="article-terms-link" href="/categories/development/">Development</a></li>
</ul>
<ul class="tags">
<li><a class="article-terms-link" href="/tags/arduino/">arduino</a></li>
<li><a class="article-terms-link" href="/tags/arduino-library/">arduino library</a></li>
<li><a class="article-terms-link" href="/tags/english/">english</a></li>
<li><a class="article-terms-link" href="/tags/open-source/">open source</a></li>
<li><a class="article-terms-link" href="/tags/rtttl/">rtttl</a></li>
</ul>
</div>
</footer>
</div>
<div class='post'>
<div>
<h2 id='say-something'>Say Something</h2>
<form id='comment-form' class='new-comment' method='POST'>
<h3 class='reply-notice hidden'>
<span class='reply-name'></span>
<a class='reply-close-btn button'><i class='fas fa-times'></i></a>
</h3>
<input type='hidden' name='options[entryId]' value='e0466ada5c89c19fa12227a28463c48f'>
<input type='hidden' name='fields[replyThread]'>
<input type='hidden' name='fields[replyID]'>
<input type='hidden' name='fields[replyName]'>
<input required name='fields[name]' type='text' placeholder='Your Name'>
<input name='fields[website]' type='text' placeholder='Your Website'>
<input required name='fields[email]' type='email' placeholder='Your Email'>
<textarea required name='fields[body]' placeholder='Your Message' rows='10'></textarea>
<div class='submit-notice'>
<strong class='submit-notice-text submit-success hidden'>Thanks for your comment! It will be shown on the site once it has been approved.</strong>
<strong class='submit-notice-text submit-failed hidden'>Sorry, there was an error with your submission. Please make sure all required fields have been completed and try again.</strong>
</div>
<button type='button' id="comment-form-submit" class='button'>Submit</button>
<button type='button' id="comment-form-submitted" class='hidden button' disabled>Submitted</button>
<button type='reset' id="comment-form-reset" class='button'>Reset</button>
</form>
</div>
<div class='comments-container'>
<h2>Comments</h2>
</div>
</div>
</article>
<div class="pagination">
<a href="/librtttl-a-c-library-with-ui-for-compressingoptimizing-the-rtttl-audio-format/" class="button left"><span>libRtttl – A c++ library (with UI) for compressing/optimizing the RTTTL audio format</span></a>
<a href="/win32arduino-a-win32-library-that-implements-most-arduino-functions/" class="button right"><span>win32Arduino: a win32 library that implements most arduino functions</span></a>
</div>
</main>
<section id="site-sidebar">
<section id="recent-posts">
<header>
<h1>Recent Posts</h1>
</header>
<article class="mini-post">
<a href="/pidvr-record-over-the-air-tv-on-a-raspberry-pi-4/" class="image" style="--bg-image:url('/wp-content/uploads/2021/03/PiDVR-Record-over-the-air-TV-on-a-Raspberry-Pi-4.jpg')">
<img class="stretchV" src="/wp-content/uploads/2021/03/PiDVR-Record-over-the-air-TV-on-a-Raspberry-Pi-4.jpg" alt>
</a>
<header>
<h2><a href="/pidvr-record-over-the-air-tv-on-a-raspberry-pi-4/">PiDVR Record over the air TV on a Raspberry Pi 4</a></h2>
<time class="published" datetime="2021-03-14 19:40:03 +0000 UTC">March 14, 2021</time>
</header>
</article>
<article class="mini-post">
<a href="/how-to-setup-macos-catalina-10-15-in-virtualbox-for-c-development-on-github/" class="image" style="--bg-image:url('/wp-content/uploads/2021/03/HOW-TO-SETUP-MACOS-CATALINA-10.15-IN-VIRTUALBOX-FOR-C-DEVELOPMENT-ON-GITHUB.jpg')">
<img class="stretchV" src="/wp-content/uploads/2021/03/HOW-TO-SETUP-MACOS-CATALINA-10.15-IN-VIRTUALBOX-FOR-C-DEVELOPMENT-ON-GITHUB.jpg" alt>
</a>
<header>
<h2><a href="/how-to-setup-macos-catalina-10-15-in-virtualbox-for-c-development-on-github/">How to setup macOS Catalina 10.15 in VirtualBox for C++ development on Github.</a></h2>
<time class="published" datetime="2021-03-14 16:42:39 +0000 UTC">March 14, 2021</time>
</header>
</article>
<article class="mini-post">
<a href="/how-to-encode-command-line-parameters-on-windows-done-right/" class="image" style="--bg-image:url('/wp-content/uploads/2017/06/How-to-encode-command-line-parameters-on-Windows-done-right.jpg')">
<img class="stretchV" src="/wp-content/uploads/2017/06/How-to-encode-command-line-parameters-on-Windows-done-right.jpg" alt>
</a>
<header>
<h2><a href="/how-to-encode-command-line-parameters-on-windows-done-right/">How to encode command line parameters on Windows – done right</a></h2>
<time class="published" datetime="2021-03-14 14:49:47 +0000 UTC">March 14, 2021</time>
</header>
</article>
<article class="mini-post">
<a href="/libargvcodec-a-c-library-which-properly-encode-and-decode-command-line-arguments/" class="image" style="--bg-image:url('/wp-content/uploads/2017/06/libArgvCodec-cplusplus-library.jpg')">
<img class="stretchV" src="/wp-content/uploads/2017/06/libArgvCodec-cplusplus-library.jpg" alt>
</a>
<header>
<h2><a href="/libargvcodec-a-c-library-which-properly-encode-and-decode-command-line-arguments/">libArgvCodec – A c++ library which properly encode and decode command line arguments</a></h2>
<time class="published" datetime="2017-06-25 16:02:08 +0000 UTC">June 25, 2017</time>
</header>
</article>
<article class="mini-post">
<a href="/libvariant-a-c-library-which-encapsulate-any-value-of-variant-types/" class="image" style="--bg-image:url('/wp-content/uploads/2016/10/libVariant-cplusplus-library.jpg')">
<img class="stretchV" src="/wp-content/uploads/2016/10/libVariant-cplusplus-library.jpg" alt>
</a>
<header>
<h2><a href="/libvariant-a-c-library-which-encapsulate-any-value-of-variant-types/">libVariant – A c++ library which encapsulate any value of variant types</a></h2>
<time class="published" datetime="2017-05-28 21:06:45 +0000 UTC">May 28, 2017</time>
</header>
</article>
<footer>
<a href="/blog" class="button">See More</a>
</footer>
</section>
<section id="categories">
<header>
<h1><a href="/categories">Categories</a></h1>
</header>
<ul>
<li>
<a href="/categories/photography/">photography<span class="count">28</span></a>
<li>
<a href="/categories/development/">development<span class="count">22</span></a>
<li>
<a href="/categories/model-aeronautics/">model aeronautics<span class="count">17</span></a>
<li>
<a href="/categories/other/">other<span class="count">9</span></a>
</li>
</ul>
</section>
<section id="mini-bio">
<header>
<h1>About</h1>
</header>
<p>Hey! I'm Antoine author of end2end zone. Take a couple of minutes to get to know me a little better.</p>
<footer>
<a href="/about" class="button">Learn More</a>
</footer>
</section>
</section>
<footer id="site-footer">
<ul class="socnet-icons">
</ul>
<p class="copyright">
© 2021 end2end zone
<br>
Theme: <a href='https://github.com/pacollins/hugo-future-imperfect-slim' target='_blank' rel='noopener'>Hugo Future Imperfect Slim</a><br>A <a href='https://html5up.net/future-imperfect' target='_blank' rel='noopener'>HTML5 UP port</a> | Powered by <a href='https://gohugo.io/' title='0.147.9' target='_blank' rel='noopener'>Hugo</a>
</p>
</footer>
<a id="back-to-top" href="#" class="fas fa-arrow-up fa-2x"></a>
<script src="/js/highlight.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.9.0/highlightjs-line-numbers.min.js"></script>
<script>hljs.configure({ignoreUnescapedHTML:!0}),hljs.highlightAll(),hljs.initLineNumbersOnLoad()</script><script src="/js/bundle.min.88c850c616696a7e395be7803f02f2fe8bb96c8d4e00c23e1b929d062fd00d40.js" integrity="sha256-iMhQxhZpan45W+eAPwLy/ou5bI1OAMI+G5KdBi/QDUA="></script>
<script src="/js/add-on.js"></script>
<script src="/js/linenumbers.js"></script>
</div>
</body>
</html>